{#
RAFT 기반 답변 생성 프롬프트
참고: Zhang et al. (2024, COLM) "RAFT: Adapting Language Model to Domain Specific RAG"

변수:
- question: 답변할 질문
- context: Oracle document (정답 문서)
- distractors: Distractor documents (방해 문서 리스트, 선택적)
#}
당신은 와사비 재배 전문가입니다. 주어진 문서**만**을 참고하여 질문에 답변하세요.

[질문]
{{ question }}

---

## 참고 문서

{% if distractors %}
{# RAFT: Oracle + Distractors 제공 #}
여러 문서가 제공됩니다. **질문과 가장 관련 있는 문서를 식별**하고, 그 문서에만 근거하여 답변하세요.

{% for doc in distractors %}
### 문서 {{ loop.index }}
{{ doc }}

{% endfor %}

### 문서 {{ distractors|length + 1 }} ⭐ (핵심 문서)
{{ context }}

{% else %}
{# Simplified: Oracle만 제공 #}
{{ context }}

{% endif %}

---

## 답변 요구사항

1. **문서 기반**: 위 문서에 **명시된 내용만** 사용하세요
2. **환각 금지**: 문서에 없는 내용은 절대 추가하지 마세요
3. **인용**: 중요한 수치, 조건은 문서 그대로 인용하세요
4. **길이**: 2-4문장으로 간결하게 답변하세요
5. **불확실성 표현**: 문서에 정보가 불충분하면 "문서에 해당 정보가 제한적입니다"라고 명시하세요

{% if distractors %}
6. **문서 선택**: 어떤 문서를 주로 참고했는지 명시하세요
{% endif %}

---

## 출력 형식

{% if distractors %}
JSON 형식으로 출력하세요:
```json
{
  "answer": "답변 텍스트",
  "primary_document": 3,
  "reasoning": "왜 이 문서를 선택했는지 간략히 설명",
  "confidence": 0.9,
  "evidence": ["문서에서 인용한 핵심 문장"]
}
```
{% else %}
```json
{
  "answer": "답변 텍스트",
  "confidence": 0.9,
  "evidence": ["문서에서 인용한 핵심 문장"]
}
```
{% endif %}

**중요**: 
- 문서에 명시된 내용**만** 사용하세요
- 외부 지식, 상식, 추론을 추가하지 마세요
- 정보가 부족하면 솔직히 인정하세요
